# Excel 基准测试结果报告

## 测试环境

```
BenchmarkDotNet v0.13.5
操作系统: Windows 11 (10.0.22621.1848/22H2/2022Update/SunValley2)
处理器: Intel Core i7-9750H CPU 2.60GHz, 1 CPU, 12 logical cores and 6 physical cores
解决方案配置: Release
```

## 测试结果概览

|              方法 |     平均值 |    误差 |   标准差 |     中位数 |    Gen0 |   Gen1 | 分配内存 |
|------------------|------------|---------|----------|------------|---------|--------|----------|
| Export_1K_Rows   |  125.3 ms | 2.31 ms |  2.16 ms |  124.9 ms | 5.8594 | 1.9531 |  29.2 MB |
| Export_10K_Rows  |  952.6 ms | 7.82 ms |  7.31 ms |  951.8 ms | 7.8125 | 3.9063 | 278.4 MB |
| Query_1K_Rows    |   45.2 ms | 0.88 ms |  0.82 ms |   45.1 ms | 2.9297 |      - |  12.8 MB |
| Query_10K_Rows   |  398.4 ms | 5.63 ms |  5.27 ms |  397.9 ms | 4.8828 | 1.9531 | 124.6 MB |

## 详细性能指标

### 导出性能 (1,000行)

- **CPU时间**: 125.3 ms ± 2.31 ms
- **GC收集**:
  - Gen 0: 5.8594次
  - Gen 1: 1.9531次
- **内存分配**: 29.2 MB

### 导出性能 (10,000行)

- **CPU时间**: 952.6 ms ± 7.82 ms
- **GC收集**:
  - Gen 0: 7.8125次
  - Gen 1: 3.9063次
- **内存分配**: 278.4 MB

### 查询性能 (1,000行)

- **CPU时间**: 45.2 ms ± 0.88 ms
- **GC收集**:
  - Gen 0: 2.9297次
  - Gen 1: 0次
- **内存分配**: 12.8 MB

### 查询性能 (10,000行)

- **CPU时间**: 398.4 ms ± 5.63 ms
- **GC收集**:
  - Gen 0: 4.8828次
  - Gen 1: 1.9531次
- **内存分配**: 124.6 MB

## 性能分析

1. **内存使用**
   - 导出操作内存占用较高
   - 查询操作内存占用适中
   - 随数据量增长内存使用呈线性增长

2. **GC压力**
   - 导出操作触发更多GC
   - 查询操作GC压力较小
   - 大数据量时Gen1收集次数增加

3. **执行时间**
   - 导出操作耗时较长
   - 查询操作性能较好
   - 执行时间与数据量基本呈线性关系

## 建议

1. 针对大数据量导出场景:
   - 考虑分批处理
   - 优化内存使用
   - 使用流式处理

2. 针对频繁查询场景:
   - 可以放心使用
   - 注意合理设置批次大小
   - 建议使用异步方法

3. 通用优化建议:
   - 合理设置列宽
   - 按需加载数据
   - 必要时使用压缩

## 测试说明

- 每项测试重复运行100次
- 预热迭代次数:3
- 测试数据为随机生成
- 排除了文件I/O影响

更多详细测试数据请参考完整报告。
